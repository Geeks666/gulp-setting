'use strict';

define(['jquery', 'template', 'layer', 'service', 'orgConfig', 'header', 'appVerify'], function ($, template, layer, service, orgConfig, header, appVerify) {

  var allData = {
    'shareResourceCount': {},
    'totalUser': {}
  };
  getShareResourceCount(orgConfig.orgIds.baiyinAreaId);
  getTotalUser(orgConfig.orgIds.baiyinAreaId);
  getVideoCount();
  function getTotalUser(areaId, orgId) {
    var key = areaId ? areaId : orgId;
    if (allData.totalUser[key] == null) {
      var url = service.htmlHost + '/pf/api/schshow/teachers';
      if (areaId) url += '?areaId=' + areaId;
      if (orgId) url += '?orgId=' + orgId;
      $.ajax({
        url: url,
        type: 'GET',
        success: function success(data) {
          if (data && data.code == "success") {
            allData.totalUser[key] = data.data;
            $(".total_user .num").text(data.data);
          } else {
            layer.alert(data.msg, { icon: 0 });
          }
        },
        error: function error(data) {
          layer.alert("获取注册用户数异常。", { icon: 0 });
        }
      });
    } else {
      $(".total_user .num").text(allData.totalUser[key]);
    }
  };
  function getShareResourceCount(areaId, orgId) {
    var key = areaId ? areaId : orgId;
    if (allData.shareResourceCount[key] == null) {
      var url = service.htmlHost + '/pf/api/qtapp/resI_shareCount';
      if (areaId) url += '?areaId=' + areaId;
      if (orgId) url += '?orgId=' + orgId;
      $.ajax({
        url: url,
        type: 'GET',
        success: function success(data) {
          if (data && data.code == "success") {
            allData.shareResourceCount[key] = data.data.data.resTotal;
            $(".teacher_ranked .share_resource_num .num,.spaceNavul1 .share_resource_num .num").text(data.data.data.resTotal);
          } else {
            layer.alert(data.msg, { icon: 0 });
          }
        },
        error: function error(data) {
          layer.alert("获取分享资源数异常。", { icon: 0 });
        }
      });
    } else {
      $(".teacher_ranked .share_resource_num .num,.spaceNavul1 .share_resource_num .num").text(allData.shareResourceCount[key]);
    }
  };
  function getVideoCount() {
    var url = service.htmlHost + '/pf/api/rank/videoCount';
    $.ajax({
      url: url,
      type: 'GET',
      success: function success(data) {
        if (data && data.code == "success") {
          $(".total_ktsl .num1").text(data.data);
        } else {
          layer.alert(data.msg, { icon: 0 });
        }
      },
      error: function error(data) {
        layer.alert("获取课堂实录总条数异常。", { icon: 0 });
      }
    });
  };

  $.each($(".spaceNavul a.spaceLink"), function () {
    if ($(this).hasClass("ktsl")) {
      $(this).attr("href", '#');
    } else {
      $(this).attr("href", service.htmlHost + $(this).attr("data-href"));
    }
  });
  $('body').delegate('.spaceNavul li.application', 'click', function (e) {
    if (!header.getUser()) {
      layer.alert("请登录后操作。", { icon: 0 });
      return false;
    }
  });

  //判断当前用户是否有权限进入课堂实录和看视频,
  $("body .wrap").delegate('.hanbo_enter', 'click', function () {
    if (header.getUser()) {
      appVerify.verifyApp(service.appIds[$(this).attr('type')], '2');
    } else {
      layer.alert("请登录后操作。", { icon: 0 });
      return;
    }
  });

  return {
    getShareResourceCount: getShareResourceCount,
    getTotalUser: getTotalUser
  };
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvbWUvanMvc2Vjb25kTmF2LmpzIl0sIm5hbWVzIjpbImRlZmluZSIsIiQiLCJ0ZW1wbGF0ZSIsImxheWVyIiwic2VydmljZSIsIm9yZ0NvbmZpZyIsImhlYWRlciIsImFwcFZlcmlmeSIsImFsbERhdGEiLCJnZXRTaGFyZVJlc291cmNlQ291bnQiLCJvcmdJZHMiLCJiYWl5aW5BcmVhSWQiLCJnZXRUb3RhbFVzZXIiLCJnZXRWaWRlb0NvdW50IiwiYXJlYUlkIiwib3JnSWQiLCJrZXkiLCJ0b3RhbFVzZXIiLCJ1cmwiLCJodG1sSG9zdCIsImFqYXgiLCJ0eXBlIiwic3VjY2VzcyIsImRhdGEiLCJjb2RlIiwidGV4dCIsImFsZXJ0IiwibXNnIiwiaWNvbiIsImVycm9yIiwic2hhcmVSZXNvdXJjZUNvdW50IiwicmVzVG90YWwiLCJlYWNoIiwiaGFzQ2xhc3MiLCJhdHRyIiwiZGVsZWdhdGUiLCJlIiwiZ2V0VXNlciIsInZlcmlmeUFwcCIsImFwcElkcyJdLCJtYXBwaW5ncyI6Ijs7QUFDQUEsT0FBTyxDQUFDLFFBQUQsRUFBWSxVQUFaLEVBQXlCLE9BQXpCLEVBQW1DLFNBQW5DLEVBQStDLFdBQS9DLEVBQTZELFFBQTdELEVBQXdFLFdBQXhFLENBQVAsRUFDSSxVQUFVQyxDQUFWLEVBQWNDLFFBQWQsRUFBeUJDLEtBQXpCLEVBQWlDQyxPQUFqQyxFQUEyQ0MsU0FBM0MsRUFBdURDLE1BQXZELEVBQWdFQyxTQUFoRSxFQUEyRTs7QUFFekUsTUFBSUMsVUFBVTtBQUNaLDBCQUF1QixFQURYO0FBRVosaUJBQWM7QUFGRixHQUFkO0FBSUFDLHdCQUF1QkosVUFBVUssTUFBVixDQUFpQkMsWUFBeEM7QUFDQUMsZUFBY1AsVUFBVUssTUFBVixDQUFpQkMsWUFBL0I7QUFDQUU7QUFDQSxXQUFTRCxZQUFULENBQXVCRSxNQUF2QixFQUFnQ0MsS0FBaEMsRUFBdUM7QUFDckMsUUFBSUMsTUFBTUYsU0FBU0EsTUFBVCxHQUFrQkMsS0FBNUI7QUFDQSxRQUFJUCxRQUFR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RkQsTUFFSztBQUNIL0IsWUFBTXVCLEtBQU4sQ0FBWSxTQUFaLEVBQXVCLEVBQUNFLE1BQU0sQ0FBUCxFQUF2QjtBQUNBO0FBQ0Q7QUFDRixHQVBEOztBQVNBLFNBQU87QUFDTG5CLDJCQUF3QkEscUJBRG5CO0FBRUxHLGtCQUFlQTtBQUZWLEdBQVA7QUFJRCxDQTFHTCIsImZpbGUiOiJob21lL2pzL3NlY29uZE5hdi0zYzBmZTE4NzY0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmRlZmluZShbJ2pxdWVyeScgLCAndGVtcGxhdGUnICwgJ2xheWVyJyAsICdzZXJ2aWNlJyAsICdvcmdDb25maWcnICwgJ2hlYWRlcicgLCAnYXBwVmVyaWZ5J10sXHJcbiAgICBmdW5jdGlvbiAoJCAsIHRlbXBsYXRlICwgbGF5ZXIgLCBzZXJ2aWNlICwgb3JnQ29uZmlnICwgaGVhZGVyICwgYXBwVmVyaWZ5KSB7XHJcblxyXG4gICAgICB2YXIgYWxsRGF0YSA9IHtcclxuICAgICAgICAnc2hhcmVSZXNvdXJjZUNvdW50JyA6IHt9LFxyXG4gICAgICAgICd0b3RhbFVzZXInIDoge31cclxuICAgICAgfTtcclxuICAgICAgZ2V0U2hhcmVSZXNvdXJjZUNvdW50KCBvcmdDb25maWcub3JnSWRzLmJhaXlpbkFyZWFJZCApO1xyXG4gICAgICBnZXRUb3RhbFVzZXIoIG9yZ0NvbmZpZy5vcmdJZHMuYmFpeWluQXJlYUlkICk7XHJcbiAgICAgIGdldFZpZGVvQ291bnQoKTtcclxuICAgICAgZnVuY3Rpb24gZ2V0VG90YWxVc2VyKCBhcmVhSWQgLCBvcmdJZCApe1xyXG4gICAgICAgIHZhciBrZXkgPSBhcmVhSWQgPyBhcmVhSWQgOiBvcmdJZDtcclxuICAgICAgICBpZiggYWxsRGF0YS50b3RhbFVzZXJba2V5XSA9PSBudWxsICl7XHJcbiAgICAgICAgICB2YXIgdXJsID0gc2VydmljZS5odG1sSG9zdCArICcvcGYvYXBpL3NjaHNob3cvdGVhY2hlcnMnO1xyXG4gICAgICAgICAgaWYoIGFyZWFJZCApIHVybCArPSAnP2FyZWFJZD0nK2FyZWFJZDtcclxuICAgICAgICAgIGlmKCBvcmdJZCApIHVybCArPSAnP29yZ0lkPScrb3JnSWQ7XHJcbiAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmwgOiB1cmwsXHJcbiAgICAgICAgICAgIHR5cGUgOidHRVQnLFxyXG4gICAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgaWYoIGRhdGEgJiYgZGF0YS5jb2RlID09IFwic3VjY2Vzc1wiICl7XHJcbiAgICAgICAgICAgICAgICBhbGxEYXRhLnRvdGFsVXNlcltrZXldID0gZGF0YS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgJChcIi50b3RhbF91c2VyIC5udW1cIikudGV4dChkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgbGF5ZXIuYWxlcnQoIGRhdGEubXNnICwge2ljb246IDB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yIDogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICBsYXllci5hbGVydChcIuiOt+WPluazqOWGjOeUqOaIt+aVsOW8guW4uOOAglwiLCB7aWNvbjogMH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICQoXCIudG90YWxfdXNlciAubnVtXCIpLnRleHQoIGFsbERhdGEudG90YWxVc2VyW2tleV0gKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIGZ1bmN0aW9uIGdldFNoYXJlUmVzb3VyY2VDb3VudCggYXJlYUlkICwgb3JnSWQgKXtcclxuICAgICAgICB2YXIga2V5ID0gYXJlYUlkID8gYXJlYUlkIDogb3JnSWQ7XHJcbiAgICAgICAgaWYoIGFsbERhdGEuc2hhcmVSZXNvdXJjZUNvdW50W2tleV0gPT0gbnVsbCApIHtcclxuICAgICAgICAgIHZhciB1cmwgPSBzZXJ2aWNlLmh0bWxIb3N0ICsgJy9wZi9hcGkvcXRhcHAvcmVzSV9zaGFyZUNvdW50JztcclxuICAgICAgICAgIGlmIChhcmVhSWQpIHVybCArPSAnP2FyZWFJZD0nICsgYXJlYUlkO1xyXG4gICAgICAgICAgaWYgKG9yZ0lkKSB1cmwgKz0gJz9vcmdJZD0nICsgb3JnSWQ7XHJcbiAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IHVybCxcclxuICAgICAgICAgICAgdHlwZTogJ0dFVCcsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5jb2RlID09IFwic3VjY2Vzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICBhbGxEYXRhLnNoYXJlUmVzb3VyY2VDb3VudFtrZXldID0gZGF0YS5kYXRhLmRhdGEucmVzVG90YWw7XHJcbiAgICAgICAgICAgICAgICAkKFwiLnRlYWNoZXJfcmFua2VkIC5zaGFyZV9yZXNvdXJjZV9udW0gLm51bSwuc3BhY2VOYXZ1bDEgLnNoYXJlX3Jlc291cmNlX251bSAubnVtXCIpLnRleHQoZGF0YS5kYXRhLmRhdGEucmVzVG90YWwpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsYXllci5hbGVydChkYXRhLm1zZywge2ljb246IDB9KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgIGxheWVyLmFsZXJ0KFwi6I635Y+W5YiG5Lqr6LWE5rqQ5pWw5byC5bi444CCXCIsIHtpY29uOiAwfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgJChcIi50ZWFjaGVyX3JhbmtlZCAuc2hhcmVfcmVzb3VyY2VfbnVtIC5udW0sLnNwYWNlTmF2dWwxIC5zaGFyZV9yZXNvdXJjZV9udW0gLm51bVwiKS50ZXh0KGFsbERhdGEuc2hhcmVSZXNvdXJjZUNvdW50W2tleV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgZnVuY3Rpb24gZ2V0VmlkZW9Db3VudCgpe1xyXG4gICAgICAgIHZhciB1cmwgPSBzZXJ2aWNlLmh0bWxIb3N0ICsgJy9wZi9hcGkvcmFuay92aWRlb0NvdW50JztcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgdXJsIDogdXJsLFxyXG4gICAgICAgICAgdHlwZSA6J0dFVCcsXHJcbiAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIGlmKCBkYXRhICYmIGRhdGEuY29kZSA9PSBcInN1Y2Nlc3NcIiApe1xyXG4gICAgICAgICAgICAgICQoXCIudG90YWxfa3RzbCAubnVtMVwiKS50ZXh0KGRhdGEuZGF0YSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgIGxheWVyLmFsZXJ0KCBkYXRhLm1zZyAsIHtpY29uOiAwfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBlcnJvciA6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGxheWVyLmFsZXJ0KFwi6I635Y+W6K++5aCC5a6e5b2V5oC75p2h5pWw5byC5bi444CCXCIsIHtpY29uOiAwfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAkLmVhY2goICQoXCIuc3BhY2VOYXZ1bCBhLnNwYWNlTGlua1wiKSAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcyhcImt0c2xcIikpe1xyXG4gICAgICAgICAgJCh0aGlzKS5hdHRyKFwiaHJlZlwiICwgJyMnICk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAkKHRoaXMpLmF0dHIoXCJocmVmXCIgLCBzZXJ2aWNlLmh0bWxIb3N0ICsgJCh0aGlzKS5hdHRyKFwiZGF0YS1ocmVmXCIpICk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgJCgnYm9keScpLmRlbGVnYXRlKCcuc3BhY2VOYXZ1bCBsaS5hcHBsaWNhdGlvbicsJ2NsaWNrJyxmdW5jdGlvbiAoIGUgKSB7XHJcbiAgICAgICAgaWYoICFoZWFkZXIuZ2V0VXNlcigpICl7XHJcbiAgICAgICAgICBsYXllci5hbGVydChcIuivt+eZu+W9leWQjuaTjeS9nOOAglwiLCB7aWNvbjogMH0pO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvL+WIpOaWreW9k+WJjeeUqOaIt+aYr+WQpuacieadg+mZkOi/m+WFpeivvuWgguWunuW9leWSjOeci+inhumikSxcclxuICAgICAgJChcImJvZHkgLndyYXBcIikuZGVsZWdhdGUoJy5oYW5ib19lbnRlcicgLCAnY2xpY2snICwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKCBoZWFkZXIuZ2V0VXNlcigpICl7XHJcbiAgICAgICAgICBhcHBWZXJpZnkudmVyaWZ5QXBwKCBzZXJ2aWNlLmFwcElkc1skKHRoaXMpLmF0dHIoJ3R5cGUnKV0gLCAnMicgKVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgbGF5ZXIuYWxlcnQoXCLor7fnmbvlvZXlkI7mk43kvZzjgIJcIiwge2ljb246IDB9KTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBnZXRTaGFyZVJlc291cmNlQ291bnQgOiBnZXRTaGFyZVJlc291cmNlQ291bnQsXHJcbiAgICAgICAgZ2V0VG90YWxVc2VyIDogZ2V0VG90YWxVc2VyXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuXHJcblxyXG4iXX0=
