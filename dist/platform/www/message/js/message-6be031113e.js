"use strict";require.config({baseUrl:"../",paths:{platformConf:"public/js/platformConf-6e48d40e05.js"}}),require(["platformConf"],function(e){require.config(e),define("",["jquery","template","service","footer","header","layer","page","jqueryUIB"],function(e,a,t,s,c,n,i,o){function l(a,s,c){var n={"page.currentPage":a,"page.pageSize":m};c&&"请选择"!=c&&(n.appName=c),e.ajax({type:"get",url:t.htmlHost+"pf/api/information/list.jsonp",dataType:"jsonp",jsonp:"callback",data:n,cache:!1,success:function(t){var n=t.data.datalist;e(".message-list").html(""),e.each(n,function(t,s){var n=e("<li>");s.isRead?n.addClass("read"):n.addClass("not-read");var i=e("<div>");i.addClass("form-check-box fl"),i.html('<div class="form-check"><span></span></div>'),i.find(".form-check").attr("data-id",s.id),i.click(function(a){e(this).find(".form-check").hasClass("checked")?e(this).find(".form-check").removeClass("checked"):e(this).find(".form-check").addClass("checked")});var o=e("<a>");o.click(function(){f(s.id,s.url,s.appName,a,c),n.attr("class","read")});var l='<div class="mes-con fl"><span class="mr8">['+s.appName+"]</span><span>"+s.title+'</span></div><span class="mes-date fr">'+s.sendDate+"</span>";n.html(i),o.html(l),n.append(o),e(".message-list").append(n)}),s||e("#page").html(""),t.data.totalPages>1&&!s&&r("page",t.data.totalCount,c,a)},error:function(e,a,t){console.log(a)}})}function r(e,a,t,s){(new i).init({target:"#"+e,pagesize:m,pageCount:8,current:s||1,count:a,callback:function(e){l(e,!0,t)}})}function p(a){a.length>0?n.confirm("您确定要删除这些消息么？",function(){n.closeAll(),e.ajax({type:"get",url:t.htmlHost+"pf/api/information/delete",dataType:"json",data:{ids:a.join(",")},success:function(a){"success"==a.code&&l(u,"",e(".form-app .type").html())},error:function(e){}})}):n.alert("您还没有选中的信息!!!")}function d(a){a.length>0?e.ajax({type:"get",url:t.htmlHost+"pf/api/information/mark",dataType:"json",cache:!1,data:{ids:a.join(",")},success:function(a){"success"==a.code&&(n.msg("已标记为已读"),setTimeout(function(){n.closeAll()},1e3),e(".checked").parents(".not-read").attr("class","read"))}}):n.alert("您还没有选中的消息!!!")}function f(a,s,c,n,i){if("人人通"!=c){var s=t.htmlHost+"pf/api/information/view/"+a;window.open(s,"_blank")}else{var s=t.htmlHost+"pf/api/information/mark?ids="+a;e.ajax({type:"get",url:s,dataType:"json",cache:!1,success:function(e){"success"==e.code&&l(n,"",i)}})}}function h(){e(".form-select").on("click",function(a){var a=a||window.event,t=a.target||a.srcElement;e(t).hasClass("select")&&(e(".types").hide(),e(t).parents(".form-select").find(".type").html(e(t).html()),"请选择"==e(t).parents(".form-select").find(".type").html()?l(u,"",""):l(u,"",e(t).parents(".form-select").find(".type").html())),e(t).hasClass("type")&&("none"==e(t).parent().find(".types").css("display")?(e(".types").hide(),e(t).parent().find(".types").show()):e(t).parent().find(".types").hide())}),e(document).on("click",function(a){var a=a||window.event;a.target||a.srcElement;e(".types").hide()}),e(".form-select").click(function(e){return!1})}var m=10,u=1;l(u,""),e(".form-check").click(function(){e(this).hasClass("checked")?e(this).hasClass("all")?e(".form-check").removeClass("checked"):e(this).removeClass("checked"):e(this).hasClass("all")?e(".form-check").addClass("checked"):e(this).addClass("checked")}),e(".btn-del").click(function(){var a=[];e(".message-list .checked").each(function(t,s){a.push(e(this).attr("data-id"))}),p(a)}),e(".btn-read").click(function(){var a=[];e(".message-list .checked").each(function(t,s){a.push(e(this).attr("data-id"))}),d(a)}),e.ajax({type:"get",url:t.htmlHost+"pf/api/information/getAppType",dataType:"json",cache:!1,success:function(a){var t='<li><p class="select" title="请选择" data-id="">请选择</p></li>';e.each(a.data,function(e,a){t+='<li><p class="select">'+a.appName+"</p></li>"}),e(".form-app .types").html(t),e(".form-app .type").html("请选择"),h()},error:function(e){}})})});