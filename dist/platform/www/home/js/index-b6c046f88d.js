"use strict";require.config({baseUrl:"../",paths:{platformConf:"public/js/platformConf-6e48d40e05.js"}}),require(["platformConf"],function(t){require.config(t),define("",["jquery","fullPage","template","layer","textScroll","tab","service","orgConfig","tools","banner","ajaxBanner","secondNav","footer","header","appVerify","album"],function(t,e,a,i,o,s,n,l,r,c,d,h,u,p,g,f){function m(e,o,s){url=s?n.htmlHost+"pf/api/news/getLimit?limit=7&category="+e+"&orgId="+s:n.htmlHost+"pf/api/news/getLimit?limit=7&category="+e,t.ajax({url:url,type:"GET",success:function(n){if(n&&"success"==n.code){var l="";n.data&&n.data.length>0?(n.category=e,t.each(n.data,function(t){n.data[t].showTitle=r.hideTextByLen(n.data[t].title,78),n.data[t].showBrief=r.hideTextByLen(n.data[t].brief,124),n.data[t].img=n.data[t].img?y(n.data[t].img):"",n.data[t].orgid=s?"&orgId="+s:""}),l=a(o+"_",n)):l=k(),t("#"+o).html(l)}else i.alert("获取新闻异常",{icon:0})},error:function(t){i.alert("获取新闻异常。",{icon:0})}})}function v(e,o,s){url=s?n.htmlHost+"/pf/api/qtapp/ktsl_recList?school_name="+s:n.htmlHost+"/pf/api/qtapp/ktsl_recList",t.ajax({url:url,type:"GET",success:function(t){if(t&&"success"==t.code){var s;s=t.data&&t.data.result&&t.data.result.data&&t.data.result.data.length>0?a(o,t):k(),e.html(s)}else i.alert("获取课堂实录异常",{icon:0})},error:function(t){i.alert("获取课堂实录异常。",{icon:0})}})}function w(e,a){var o=e||a;if(null==j.loginedTeaNums[o]){var s=n.htmlHost+"/pf/api/schshow/loginedTeaNums";e&&(s+="?areaId="+e),a&&(s+="?orgId="+a),t.ajax({url:s,type:"GET",success:function(e){e&&"success"==e.code?(j.loginedTeaNums[o]=e.data,t(".teacher_ranked .teacherNum .num").text(e.data)):i.alert(e.msg,{icon:0})},error:function(t){i.alert("获取在线用户数异常。",{icon:0})}})}else t(".teacher_ranked .teacherNum .num").text(j.loginedTeaNums[o])}function b(e,o,s,l,r,c){var d=r||c;if(null==j.teaSorts[d]){var h={"page.currentPage":s,"page.pageSize":l};c&&(h.orgId=c),t.ajax({url:n.htmlHost+"/pf/api/by/teaSort",type:"GET",data:h,success:function(t){if(t&&"success"==t.code){var s="";t.data&&t.data.length>0?(j.teaSorts[d]=t,s=a(o,t)):s=k(),e.html(s),e.css("margin-left","0px"),C=0,e.find("ul.listPage").length>0?e.width(e.find("ul.listPage").length*parseInt(e.find("ul.listPage").width())):e.width(e.parent().width()),e.parents(".box").find("a.prev").hide(),e.find("ul.listPage").length<=1?e.parents(".box").find("a.next").hide():e.parents(".box").find("a.next").show()}else i.alert(t.msg,{icon:0})},error:function(t){i.alert("获取老师排行异常。",{icon:0})}})}else e.html(a(o,j.teaSorts[d])),e.css("margin-left","0px"),C=0,e.find("ul.listPage").length>0?e.width(e.find("ul.listPage").length*parseInt(e.find("ul.listPage").width())):e.width(e.parent().width()),e.parents(".box").find("a.prev").hide(),e.find("ul.listPage").length<=1?e.parents(".box").find("a.next").hide():e.parents(".box").find("a.next").show()}function x(e,o,s,l,r,c){var d=r||c;if(null==j.hotspaces[d]&&(j.hotspaces[d]={}),null==j.hotspaces[d][s]){var h={type:s,pageSize:l,currentPage:1};r&&(h.areaId=r),c&&(h.orgId=c),t.ajax({url:n.htmlHost+"/pf/api/qtapp/rrt_hotspace",type:"GET",data:h,success:function(n){if(n&&"success"==n.code){var l="";if(n.data&&n.data.data&&n.data.data.length>0){!function(e){if("2"==e||"3"==e||"5"==e||"6"==e)t.each(n.data.data,function(t){n.data.data[t].spaceUrl=n.msg+"/"+n.data.data[t].spaceUrl+"&requireLogin=false",n.data.data[t].icon=n.data.data[t].icon?n.data.data[t].icon:I(e),n.data.data[t].name=n.data.data[t].label.length>10?n.data.data[t].name.substring(0,9)+"...":n.data.data[t].name,n.data.data[t].label=n.data.data[t].label.length>12?n.data.data[t].label.substring(0,11)+"...":n.data.data[t].label});else if("subject"==e){var a=[100,103,104,106,107,165,265,166,172,173,174,933,171,170,167],i=[],o=0;t.each(n.data.data,function(t,e){for(var s=!1,n=e.spaceUrl.split("&")[2].split("=")[1],t=0;t<a.length;t++)if(parseInt(n)==a[t]){e.icon=getpicture(parseInt(n)),s=!0;break}s||(e.icon=getpicture("other")),i[o]=e,o++}),t.each(i,function(t){i[t].spaceUrl=n.msg+"/"+i[t].spaceUrl})}else"school"==e&&t.each(n.data.data,function(t){n.data.data[t].spaceUrl=n.msg+"/"+n.data.data[t].spaceUrl,n.data.data[t].icon=n.data.data[t].icon?n.data.data[t].icon:I("subject")})}(s),l='<li class="album_big"><span href="javascript:;" id="you_logo">教师空间</span></li>'+a(o,n.data),e.html(l),e.find("p").remove()}else l='<li class="album_big"><span href="javascript:;" id="you_logo">教师空间</span></li>'+k(),e.html(l)}else i.alert(n.msg,{icon:0})},error:function(t){var e={other:"热门空间",subject:"热门学科空间",school:"热门学校空间"};i.alert("获取"+(e[s]?e[s]:e.other)+"异常",{icon:0})}})}else e.html(a(o,j.hotspaces[d][s])),e.css("margin-left","0px")}function y(t){return"http"===n.path_url.download_url.substring(0,4)?n.path_url.download_url.replace("#resid#",t):n.prefix+n.path_url.download_url.replace("#resid#",t)}function k(){return"<p id='no-content'>没有您查看的内容</p>"}function I(t){var e={3:"./images/studentPic.png",2:"./images/teacherPic.png",6:"./images/teacherPic.png",5:"./images/teacherPic.png",subject:"./images/orgPic.png",school:"./images/orgPic.png",class:"./images/classPic.png",area:"./images/orgPic.png",other:"./images/orgPic.png"};return t&&e[t]?e[t]:e.other}function B(t,e,a){this.target=t,this.target.css({position:"relative"}),this.$li=t.children(),this.length=this.$li.length,this.height=e||50,this.speed=1e3,this.starNum=0;var i=this;this.length>=4&&(this.target.html(this.target.html()+this.target.html()),setTimeout(function(){i.move()},a))}function _(t,e,a){e.animate({"margin-left":a*-t},800,function(){U=!0})}function L(e){var a=[],i=[],o=[],s=[],l=0,r="";url=e?n.htmlHost+"pf/api/news/getLimit?isImg=1&limit=5&orgId="+e:n.htmlHost+"pf/api/news/getLimit?isImg=1&limit=5",t.ajax({url:url,type:"GET",success:function(e){if(e&&"success"==e.code)if(e.data.length>0){for(var n=0;n<e.data.length;n++)a.push(e.data[n].title),i.push(y(e.data[n].img)),o.push(e.data[n].id),"教育新闻"==e.data[n].category?s.push(1):"成果展示"==e.data[n].category&&s.push(2),r+="<li></li>";a.length>1&&t(".pictureBlock .imgtab").html(r),t(".pictureBlock .imgTitle").show()}else t(".pictureBlock .imgtab").html("")}}).then(function(n){function r(){t(".pictureBlock img").attr({src:i[l]}),t(".pictureBlock a").attr({href:"../news/sitenewsDetail.html?id="+o[l]+"&index="+l+"&category="+s[l]+"&isImg=1"+c}),t(".pictureBlock .imgTitle").html(a[l]).show(),t(".pictureBlock .imgtab li").eq(l).addClass("active").siblings("li").removeClass("active"),++l==a.length&&(l=0)}var c=e?"&orgId="+e:"";r(),a.length>1?(A=setInterval(r,3e3),t(".pictureBlock").hover(function(){clearInterval(A),A=null},function(){a.length>1&&(clearInterval(A),A=setInterval(r,3e3))}),t(".pictureBlock .imgtab li").on("click",function(e){l=t(this).index(),r()})):(t(".pictureBlock").find("a").attr("href","javascript:void(0)"),t(".pictureBlock").find("img").attr("src","images/default_news.jpg"),t(".pictureBlock .imgTitle").hide().html(""),t(".pictureBlock").unbind("mouseenter").unbind("mouseleave"))},function(t){console.log(t)})}function T(e,a,i,o){var s=e.find("li").length;o*s<1e3?(e.css("width","1000"),t(".schoolList .schoolListBox").css({top:"-20px"}),t(".schoolBlockBox .next").css("display","none"),t(".schoolBlockBox .prev").css("display","none")):(e.css("width",o*s),t(".schoolList .schoolListBox").css({top:"0px"}),t(".schoolBlockBox .next").show(),t(".schoolBlockBox .prev").show());var n=a,l=i,r=e,c=r.find("li").outerWidth(!0);l.click(function(){r.stop().animate({"margin-left":-c},300,function(){r.find("li").eq(0).appendTo(r),r.css({"margin-left":0})})}),n.click(function(){r.find("li:last").prependTo(r),r.css({"margin-left":-c}),r.stop().animate({"margin-left":0},300)})}function P(e,o,s){if(s)var l=n.prefix+"renrentong/schoolpictures/100/1?orgId="+s;else var l=n.prefix+"/renrentong/schoolpictures/100/1";t.ajax({url:l,type:"GET",success:function(s){if(s&&"200"==s.code){var n="";if(s.data.data&&s.data.data.length>0){for(var l=0;l<s.data.data.length;l++)s.data.data[l].id=""==s.data.data[l].id?"images/3.gif":y(s.data.data[l].id),s.data.data[l].num=l;n=a(o,s.data)}else n=k();e.html(n),t(".schoolListBox").children(".no-content")&&t(".schoolListBox").css("position","initial"),T(t(".schoolListBox"),t(".schoolBlockBox .prev"),t(".schoolBlockBox .next"),240),T(t("#picImg"),t(".picImgLeft"),t(".picImgRight"),797)}else i.alert("获取校园风采异常",{icon:0})},error:function(t){i.alert("获取校园风采异常。",{icon:0})}})}var S=l.orgIds.baiyinAreaId,j={loginedTeaNums:{},schools:{},dynamics:{},teaSorts:{},hotspaces:{}},A=null;!function(e,o){t.ajax({url:n.htmlHost+"/pf/api/notice/getLimit?limit=10",type:"GET",success:function(t){if(t&&"success"==t.code){var s=a(o,t);e.html(s)}else i.alert("获取公告异常",{icon:0})},error:function(t){i.alert("获取公告异常。",{icon:0})}})}(t(".notice_list"),"noticeList"),m("1","newsShowBox"),m("2","resultShowBox"),x(t("#Album"),"Album_","2",26,l.orgIds.baiyinAreaId),v(t("#videoList"),"videoList_"),w(l.orgIds.baiyinAreaId),b(t("#teaSort>div"),"teaSort_",1,30,l.orgIds.baiyinAreaId),function(e,o,s){t.ajax({url:n.htmlHost+"/pf/api/friend/list?type="+s+"&limit=12",type:"GET",success:function(t){if(t&&"success"==t.code){var s="";if(t.data&&t.data.length>0){for(var n=0;n<t.data.length;n++)t.data[n].pic=y(t.data[n].pic);s=a(o,t)}else s=k();e.html(s)}else i.alert("获取友情链接异常",{icon:0})},error:function(t){i.alert("获取友情链接异常。",{icon:0})}})}(t("#link_content"),"linkContent",0),function(){t(".icon-resource").attr("href",n.sourcePlatformBase+"/syncTeaching/index"),t(".icon-rank").attr("href",n.htmlHost+"/dist/platform/www/rank/allRank.html"),t("#teacherRanked").attr("href",n.htmlHost+"/dist/platform/www/rank/teacherRank.html"),t(".icon-yk").attr("href",n.htmlHost+"/dist/platform/www/home/feitianUclass.html"),t("body").delegate(".icon-activity","click",function(){t.ajax({url:n.activityHost+"/anonymous/activityIndex",type:"GET",dataType:"jsonp",jsonp:"callback",success:function(t){"success"==t.code?window.open(n.activityHost+t.data+(p.getUser()?"?login=true":"?login=false"),"_target"):i.alert(t.msg,{icon:0})},error:function(t){i.alert("服务器异常",{icon:0})}})}),t("#applistMore>a").attr("href",n.htmlHost+"/dist/platform/www/app/app.html")}(),function(){t.ajax({url:n.htmlHost+"/pf/api/header/more",type:"GET",success:function(e){e&&"success"==e.code?t(".icon-studio").attr("href",e.data.msgzs_more):alert("初始化数据异常")}})}(),B.prototype.move=function(){var t=this;this.starNum++,this.starNum>this.length&&(this.starNum=1,this.target.css("top",0)),this.target.animate({top:"-"+this.starNum*this.height+"px"},this.speed,function(){setTimeout(function(){t.move(t.starNum)},1e3)})},t("body").delegate(".listPic","click",function(e){e.stopPropagation(),t(".listPic").removeClass("active"),t(this).addClass("active"),t(".showPic",".showBox").find("img").attr("src",t(this).find("img").attr("src"))});setInterval(function(){var e=0;t(".listPic.active").index()<t(".listPic").length-1&&(e=parseInt(t(".listPic.active").index())+1),t(".listPic").eq(e).click()},5e3);t("body").delegate(".searchBtn_wrap","click",function(e){if(e.stopPropagation(),""==t.trim(t(this).siblings(".searchText").val()))return i.alert("请输入搜索内容",{icon:0}),!1;window.location.href=n.sourcePlatformBase+"/syncTeaching/index?title="+encodeURIComponent(t.trim(t(this).siblings(".searchText").val()))+"&requireLogin=false"}),t("body .wrap").delegate(".verify_app_enter","click",function(){if(!p.getUser())return void i.alert("请登录后操作。",{icon:0});g.verifyApp(n.appIds[t(this).attr("type")],"2")}),t("body").delegate("#activityRegister,#reviewEnter","click",function(){var e=n.activityHost+"/anonymous/activityIndex";if("reviewEnter"==t(this).attr("id"))return p.getUser()?"3001"==p.getUserRole()||"3002"==p.getUserRole()||"3003"==p.getUserRole()?void(window.location.href=n.activityHost+"/temp/activity/www/background/index.html"):void i.alert("您没有权限",{icon:0}):void i.alert("请登录后再试",{icon:0});t.ajax({url:e,type:"GET",dataType:"jsonp",jsonp:"callback",success:function(t){"success"==t.code?window.location.href=n.activityHost+t.data+(p.getUser()?"?login=true":"?login=false"):i.alert(t.msg,{icon:0})},error:function(t){i.alert("服务器异常",{icon:0})}})}),t("body").delegate("#jxds,#ftyk","click",function(){if(!p.getUser())return void i.alert("请登录后操作。",{icon:0});window.open(t(this).find("a").attr("data-href"),"_blank")});var U=!0,H=t("#teaSort>div"),C=0;t("body").delegate(".teacher_ranked .next","click",function(e){U&&(C++,U=!1,_(C,H,parseInt(H.find("ul").width())),H.find("ul").length-1==C&&t(this).hide(),t(this).parents(".teacher_ranked").find("a.prev").show())}),t("body").delegate(".teacher_ranked .prev","click",function(e){U&&(C--,U=!1,_(C,H,parseInt(H.find("ul").width())),0==C&&t(this).hide(),t(this).parents(".teacher_ranked").find("a.next").show())}),t("body").on("click",".schoolTitle",function(){t(".schoolMenu").hide(),t(this).next().show()}),t(window).scroll(function(){t(window).scrollTop()>=t(window).height()?t("#others").show():t("#others").hide()}),t("#goTop").click(function(){t("html,body").animate({scrollTop:0},500)});new f("#Album");L(),t(".tabNewsAndResult a").on("click",function(e){t(this).addClass("active").siblings().removeClass("active"),t(".news").eq(t(this).index()).show().siblings(".news").hide()}),P(t("#picImg"),"pictureList1"),P(t(".schoolListBox"),"schoolShow_"),t("body").on("click",".schoolListBox li",function(){var e=t(this).data("num");t(".mask").show(),t(".picDialog").show(),t("body").css("overflow-y","hidden"),t("#picImg").append(t("#picImg li:lt("+t("#picImg li[data-num="+e+"]").index()+")"))}),t("body").on("click",".closeDialog",function(){t(".mask").hide(),t(".picDialog").hide(),t("body").css("overflow-y","auto")}),t("body").delegate(".schoolChoose ul li.list>span","click",function(e){e.stopPropagation();var i=this;if(S=t(i).attr("data-id"),t(i).parents(".chooseArea").find(".scholl_name").text(t(i).find("a").text()).attr("title",t(i).find("a").attr("title")).attr("data-id",t(i).attr("data-id")),t(i).parents(".chooseList").hide(),t(i).parents(".chooseArea.tabchoose").find(".arrow").addClass("arrowDown").removeClass("arrowUp"),t(".schoolChoose #schoolList li.list>span").length-1==p.getSchoolList().length&&t(i).attr("data-id")==l.orgIds.baiyinAreaId)h.getShareResourceCount(l.orgIds.baiyinAreaId),h.getTotalUser(l.orgIds.baiyinAreaId),w(l.orgIds.baiyinAreaId),b(t("#teaSort>div"),"teaSort_",1,30,l.orgIds.baiyinAreaId),x(t("#Album"),"Album_","2",26,t(i).attr("data-id")),new f("#Album"),window.clearInterval(A),A=null,L(),m("1","newsShowBox"),m("2","resultShowBox"),v(t("#videoList"),"videoList_"),P(t("#picImg"),"pictureList1"),P(t(".schoolListBox"),"schoolShow_"),t("#schoolList").html(a("school_list",{data:p.getSchoolList()}));else{var o=t(i).attr("data-id"),s=t(i).children().attr("title");h.getShareResourceCount(null,t(i).attr("data-id")),h.getTotalUser(null,t(i).attr("data-id")),w(null,t(i).attr("data-id")),b(t("#teaSort>div"),"teaSort_",1,30,null,t(i).attr("data-id")),x(t("#Album"),"Album_","2",26,null,t(i).attr("data-id")),new f("#Album"),window.clearInterval(A),A=null,L(o),m("1","newsShowBox",o),m("2","resultShowBox",o),v(t("#videoList"),"videoList_",encodeURIComponent(s)),P(t("#picImg"),"pictureList1",o),P(t(".schoolListBox"),"schoolShow_",o),t(".schoolChoose #schoolList li.list>span").length==p.getSchoolList().length&&(t(".hotSpace .hotNav>li[type!='2']").hide(),t("#schoolList").html(a("school_list",{data:[{id:l.orgIds.baiyinAreaId,name:"白银区",showName:"白银区"}].concat(p.getSchoolList())})))}})})});